# Logrotate configuration for WetWijzer/LisLoi
# Ensures GDPR compliance: server logs retained for max 90 days
#
# Installation on production server:
#   sudo cp config/logrotate.conf /etc/logrotate.d/wetwijzer
#   sudo chown root:root /etc/logrotate.d/wetwijzer
#   sudo chmod 644 /etc/logrotate.d/wetwijzer
#
# Test rotation:
#   sudo logrotate -d /etc/logrotate.d/wetwijzer

# Puma application logs (production & staging)
/var/log/puma/wetwijzer*.log {
    daily
    missingok
    rotate 90
    compress
    delaycompress
    notifempty
    copytruncate
    dateext
    dateformat -%Y%m%d
    maxage 90
    
    postrotate
        # Signal Puma to reopen log files (if needed)
        # systemctl reload puma-wetwijzer-production || true
    endscript
}

# Nginx access logs (if any)
/var/log/nginx/wetwijzer*.log {
    daily
    missingok
    rotate 90
    compress
    delaycompress
    notifempty
    create 0640 www-data adm
    sharedscripts
    dateext
    dateformat -%Y%m%d
    maxage 90
    
    postrotate
        [ -f /var/run/nginx.pid ] && kill -USR1 `cat /var/run/nginx.pid`
    endscript
}
